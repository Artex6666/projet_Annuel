<div class="container py-5">
  <h2 class="mb-5 text-center fw-bold display-5">Toutes les annonces</h2>
  <form id="annonceFilters" class="row g-3 mb-4 justify-content-center">
    <div class="col-md-3">
      <label for="filterDate" class="form-label">Date</label>
      <input type="date" class="form-control" id="filterDate">
    </div>
    <div class="col-md-2">
      <label for="filterMinRem" class="form-label">Rémunération min (€)</label>
      <input type="number" class="form-control" id="filterMinRem" min="0" step="0.01">
    </div>
    <div class="col-md-2">
      <label for="filterMaxRem" class="form-label">Rémunération max (€)</label>
      <input type="number" class="form-control" id="filterMaxRem" min="0" step="0.01">
    </div>
    <div class="col-md-3">
      <label for="filterType" class="form-label">Type</label>
      <select class="form-control" id="filterType">
        <option value="">Tous</option>
        <option value="Colis">Colis</option>
        <option value="Service à la personne">Service à la personne</option>
        <option value="Transport de personne">Transport de personne</option>
        <option value="Courses">Courses</option>
        <option value="Achat à l'étranger">Achat à l'étranger</option>
        <option value="Garde d'animaux">Garde d'animaux</option>
        <option value="Petits travaux">Petits travaux</option>
      </select>
    </div>
    <div class="col-md-2 d-flex align-items-end">
      <button type="reset" class="btn btn-outline-secondary w-100">Réinitialiser</button>
    </div>
  </form>
  <div class="row g-4" id="annoncesList">
    <% annonces.forEach(function(annonce) { %>
      <div class="col-12 col-md-6 col-lg-4 annonce-item" 
        data-date="<%= annonce.date %>" 
        data-remuneration="<%= annonce.remuneration %>" 
        data-type="<%= annonce.type %>">
        <div class="card h-100 shadow annonce-card border-0 animate-fadein">
          <img src="<%= annonce.image ? 'http://localhost:3000' + annonce.image : '/images/no-image.png' %>" alt="Image annonce" class="card-img-top" style="max-height:180px;object-fit:cover;">
          <div class="card-body d-flex flex-column justify-content-between">
            <div>
              <h5 class="card-title mb-2"><i class="bi bi-box-seam text-success me-2"></i><%= annonce.titre %></h5>
              <p class="card-text mb-2"><%= annonce.description %></p>
              <ul class="list-unstyled mb-3">
                <li><i class="bi bi-geo-alt text-primary"></i> <strong>Départ :</strong> <%= annonce.depart %></li>
                <li><i class="bi bi-flag text-warning"></i> <strong>Arrivée :</strong> <%= annonce.arrivee %></li>
                <li><i class="bi bi-calendar-event text-info"></i> <strong>Date :</strong> <%= annonce.date %></li>
                <li><i class="bi bi-cash-coin text-success"></i> <strong>Rémunération :</strong> <%= annonce.remuneration %> €</li>
                <li><i class="bi bi-tag text-info"></i> <strong>Type :</strong> <%= annonce.type %></li>
              </ul>
            </div>
            <a href="/annonces/<%= annonce.id %>" class="btn btn-outline-primary w-100 mt-auto">Voir l'annonce</a>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
</div>
<style>
.annonce-card { transition: box-shadow 0.2s, transform 0.2s; border-radius: 1.2rem; }
.annonce-card:hover { box-shadow: 0 8px 32px rgba(41,128,185,0.13); transform: translateY(-6px) scale(1.03); }
</style>
<script>

  document.addEventListener('DOMContentLoaded', function() {
    const annonceItems = Array.from(document.querySelectorAll('.annonce-item'));
    const filterDate = document.getElementById('filterDate');
    const filterMinRem = document.getElementById('filterMinRem');
    const filterMaxRem = document.getElementById('filterMaxRem');
    const filterType = document.getElementById('filterType');
    const form = document.getElementById('annonceFilters');

    function applyFilters() {
      const date = filterDate.value;
      const minRem = parseFloat(filterMinRem.value) || 0;
      const maxRem = parseFloat(filterMaxRem.value) || Infinity;
      const type = filterType.value;
      annonceItems.forEach(a => {
        const aDate = a.getAttribute('data-date');
        const aRem = parseFloat(a.getAttribute('data-remuneration'));
        const aType = a.getAttribute('data-type');
        let show = true;
        if (date && aDate !== date) show = false;
        if (aRem < minRem) show = false;
        if (aRem > maxRem) show = false;
        if (type && aType !== type) show = false;
        a.style.display = show ? '' : 'none';
      });
    }
    [filterDate, filterMinRem, filterMaxRem, filterType].forEach(input => {
      input.addEventListener('input', applyFilters);
    });
    form.addEventListener('reset', function() {
      setTimeout(applyFilters, 10);
    });
  });
</script>
